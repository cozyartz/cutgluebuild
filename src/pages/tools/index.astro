---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getAuthService, getSessionFromRequest } from '../../lib/auth';
import type { Env } from '../../lib/database';

// Check authentication before allowing access
const env = (Astro.locals as any)?.runtime?.env as Env;
const sessionId = getSessionFromRequest(Astro.request);

if (!sessionId) {
  return Astro.redirect('/signup?redirect=' + encodeURIComponent('/tools'));
}

const authService = getAuthService(env);
const currentUser = sessionId ? await authService.getCurrentUser(sessionId) : null;

if (!currentUser) {
  return Astro.redirect('/signup?redirect=' + encodeURIComponent('/tools'));
}

// Structured Data for Tools Page
const toolsSchema = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "AI CNC Tools",
  "description": "Professional AI-powered tools for CNC machining and laser cutting automation",
  "mainEntity": [
    {
      "@type": "SoftwareApplication",
      "name": "AI SVG Generator",
      "applicationCategory": "DesignApplication",
      "description": "Generate laser-cutting ready SVG files from text descriptions using artificial intelligence",
      "operatingSystem": "Web Browser"
    },
    {
      "@type": "SoftwareApplication", 
      "name": "Project Ideas Generator",
      "applicationCategory": "DesignApplication",
      "description": "AI-powered project ideation for woodworking, metalworking, and fabrication",
      "operatingSystem": "Web Browser"
    },
    {
      "@type": "SoftwareApplication",
      "name": "Image Vectorizer", 
      "applicationCategory": "DesignApplication",
      "description": "Convert photos and images to vector formats for precision cutting",
      "operatingSystem": "Web Browser"
    }
  ],
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://cutgluebuild.com"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "AI Tools",
        "item": "https://cutgluebuild.com/tools"
      }
    ]
  }
};
---

<Layout 
  title="Professional AI CNC Tools | Smart Workshop Automation"
  description="Complete suite of AI-powered CNC and laser cutting tools. Generate SVG designs, optimize workflows, and automate fabrication processes for makers and manufacturers."
  keywords="AI CNC tools, laser cutting automation, smart fabrication software, SVG generator, workshop AI assistant, precision cutting tools"
  structuredData={toolsSchema}
>
  <Header />
  
  <main class="pt-20 min-h-screen bg-gray-50 dark:bg-gray-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <!-- Hero Section -->
      <div class="text-center mb-16">
        <h1 class="text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white mb-6">
          AI-Powered
          <span class="bg-gradient-to-r from-primary-500 to-secondary-500 bg-clip-text text-transparent">
            Creative Tools
          </span>
        </h1>
        <p class="text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
          Transform your ideas into laser-ready designs in minutes. No design experience required.
        </p>
      </div>

      <!-- Tools Grid -->
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
        <!-- AI SVG Generator -->
        <div class="card card-hover p-8 text-center group">
          <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-primary-500 to-secondary-500 rounded-2xl flex items-center justify-center transform group-hover:scale-110 transition-transform duration-300">
            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v6a2 2 0 002 2h4a2 2 0 002-2V5z"></path>
            </svg>
          </div>
          <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-4">AI SVG Generator</h3>
          <p class="text-gray-600 dark:text-gray-300 mb-6">
            Describe your idea and get laser-ready SVG files with proper cut/engrave layers in seconds.
          </p>
          <div class="space-y-3 mb-6">
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Glowforge & Cricut ready
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Multiple material options
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Instant download
            </div>
          </div>
          <a href="/tools/svggen" class="btn btn-primary w-full group-hover:shadow-lg transition-shadow duration-300">
            Try SVG Generator
          </a>
        </div>

        <!-- Project Ideas Generator -->
        <div class="card card-hover p-8 text-center group">
          <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-secondary-500 to-primary-500 rounded-2xl flex items-center justify-center transform group-hover:scale-110 transition-transform duration-300">
            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
          </div>
          <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-4">Project Ideas</h3>
          <p class="text-gray-600 dark:text-gray-300 mb-6">
            Get personalized project suggestions based on your materials, tools, and skill level.
          </p>
          <div class="space-y-3 mb-6">
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Skill-based suggestions
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Material recommendations
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Step-by-step guides
            </div>
          </div>
          <a href="/tools/projectgen" class="btn btn-primary w-full group-hover:shadow-lg transition-shadow duration-300">
            Get Project Ideas
          </a>
        </div>

        <!-- Upload & Vectorize -->
        <div class="card card-hover p-8 text-center group">
          <div class="w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-green-500 to-blue-500 rounded-2xl flex items-center justify-center transform group-hover:scale-110 transition-transform duration-300">
            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
            </svg>
          </div>
          <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-4">Upload & Vectorize</h3>
          <p class="text-gray-600 dark:text-gray-300 mb-6">
            Convert photos and images into clean, laser-ready vector files with AI-powered tracing.
          </p>
          <div class="space-y-3 mb-6">
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Smart edge detection
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Multiple output formats
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
              <svg class="w-4 h-4 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Batch processing
            </div>
          </div>
          <a href="/tools/upload" class="btn btn-primary w-full group-hover:shadow-lg transition-shadow duration-300">
            Upload Images
          </a>
        </div>
      </div>

      <!-- Recent Projects -->
      <section class="mb-16">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl font-bold text-gray-900 dark:text-white">Recent Projects</h2>
          <button class="btn btn-outline">View All Projects</button>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div class="card card-hover p-6">
            <div class="aspect-square bg-gradient-to-br from-orange-100 to-orange-200 dark:from-orange-900 dark:to-orange-800 rounded-lg mb-4 flex items-center justify-center">
              <svg class="w-12 h-12 text-orange-500" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2L2 7V10C2 16 6 20.5 12 22C18 20.5 22 16 22 10V7L12 2Z"/>
              </svg>
            </div>
            <h3 class="font-semibold text-gray-900 dark:text-white mb-2">Geometric Shield</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Created 2 days ago</p>
            <div class="flex space-x-2">
              <button class="btn btn-outline text-sm flex-1">Edit</button>
              <button class="btn btn-primary text-sm flex-1">Download</button>
            </div>
          </div>
          
          <div class="card card-hover p-6">
            <div class="aspect-square bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900 dark:to-blue-800 rounded-lg mb-4 flex items-center justify-center">
              <svg class="w-12 h-12 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2Z"/>
              </svg>
            </div>
            <h3 class="font-semibold text-gray-900 dark:text-white mb-2">Custom Box</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Created 1 week ago</p>
            <div class="flex space-x-2">
              <button class="btn btn-outline text-sm flex-1">Edit</button>
              <button class="btn btn-primary text-sm flex-1">Download</button>
            </div>
          </div>
          
          <div class="card card-hover p-6 opacity-50">
            <div class="aspect-square bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700 rounded-lg mb-4 flex items-center justify-center">
              <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
              </svg>
            </div>
            <h3 class="font-semibold text-gray-900 dark:text-white mb-2">New Project</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Start creating</p>
            <button class="btn btn-primary text-sm w-full">Create Project</button>
          </div>
        </div>
      </section>

      <!-- Usage Stats -->
      <section class="card p-8">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Today's Usage</h2>
        
        <div class="grid md:grid-cols-3 gap-6">
          <div class="text-center p-6 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
            <div class="text-3xl font-bold text-blue-600 dark:text-blue-400 mb-2">3</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">AI Tools Used</div>
            <div class="text-xs text-gray-500 dark:text-gray-500 mt-1">97 remaining</div>
            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mt-3">
              <div class="bg-blue-600 h-2 rounded-full" style="width: 3%"></div>
            </div>
          </div>
          
          <div class="text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-lg">
            <div class="text-3xl font-bold text-green-600 dark:text-green-400 mb-2">2</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Projects Created</div>
            <div class="text-xs text-gray-500 dark:text-gray-500 mt-1">This session</div>
          </div>
          
          <div class="text-center p-6 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
            <div class="text-3xl font-bold text-purple-600 dark:text-purple-400 mb-2">5</div>
            <div class="text-sm text-gray-600 dark:text-gray-400">Downloads</div>
            <div class="text-xs text-gray-500 dark:text-gray-500 mt-1">This week</div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <Footer />
</Layout>